"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3328],{3524:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"reference/data-formats/events","title":"Event Data Format","description":"TrainLoop SDKs collect LLM interaction data in a standardized JSONL format.","source":"@site/docs/reference/data-formats/events.md","sourceDirName":"reference/data-formats","slug":"/reference/data-formats/events","permalink":"/reference/data-formats/events","draft":false,"unlisted":false,"editUrl":"https://github.com/trainloop/evals/tree/main/docs/docs/reference/data-formats/events.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Data Formats","permalink":"/reference/data-formats/"},"next":{"title":"Results Data Format","permalink":"/reference/data-formats/results"}}');var r=t(4848),i=t(8453);const d={sidebar_position:1},l="Event Data Format",a={},c=[{value:"Overview",id:"overview",level:2},{value:"File Structure",id:"file-structure",level:2},{value:"Event Schema",id:"event-schema",level:2},{value:"Basic Event Structure",id:"basic-event-structure",level:3},{value:"Complete Event Example",id:"complete-event-example",level:3},{value:"Field Descriptions",id:"field-descriptions",level:2},{value:"Root Fields",id:"root-fields",level:3},{value:"Input Fields",id:"input-fields",level:3},{value:"Output Fields",id:"output-fields",level:3},{value:"Usage Fields",id:"usage-fields",level:3},{value:"Metadata Fields",id:"metadata-fields",level:3},{value:"Provider-Specific Examples",id:"provider-specific-examples",level:2},{value:"OpenAI",id:"openai",level:3},{value:"Anthropic",id:"anthropic",level:3},{value:"Error Events",id:"error-events",level:2},{value:"Streaming Events",id:"streaming-events",level:2},{value:"Custom Tags",id:"custom-tags",level:2},{value:"Reading Event Data",id:"reading-event-data",level:2},{value:"Command Line",id:"command-line",level:3},{value:"Python",id:"python",level:3},{value:"SQL (via DuckDB)",id:"sql-via-duckdb",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"See Also",id:"see-also",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"event-data-format",children:"Event Data Format"})}),"\n",(0,r.jsx)(n.p,{children:"TrainLoop SDKs collect LLM interaction data in a standardized JSONL format."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["Event data is stored as newline-delimited JSON (JSONL) files in the ",(0,r.jsx)(n.code,{children:"data/events/"})," folder. Each line represents a single LLM interaction."]}),"\n",(0,r.jsx)(n.h2,{id:"file-structure",children:"File Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"data/\n\u251c\u2500\u2500 events/\n\u2502   \u251c\u2500\u2500 2024-01-15.jsonl    # Events from January 15, 2024\n\u2502   \u251c\u2500\u2500 2024-01-16.jsonl    # Events from January 16, 2024\n\u2502   \u2514\u2500\u2500 ...\n"})}),"\n",(0,r.jsx)(n.h2,{id:"event-schema",children:"Event Schema"}),"\n",(0,r.jsx)(n.h3,{id:"basic-event-structure",children:"Basic Event Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": { ... },\n  "output": { ... },\n  "metadata": { ... }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"complete-event-example",children:"Complete Event Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": {\n    "model": "gpt-4o-mini",\n    "messages": [\n      {\n        "role": "system",\n        "content": "You are a helpful assistant."\n      },\n      {\n        "role": "user",\n        "content": "What is the capital of France?"\n      }\n    ],\n    "temperature": 0.7,\n    "max_tokens": 1000,\n    "top_p": 1.0,\n    "frequency_penalty": 0.0,\n    "presence_penalty": 0.0\n  },\n  "output": {\n    "content": "The capital of France is Paris.",\n    "role": "assistant",\n    "usage": {\n      "prompt_tokens": 25,\n      "completion_tokens": 8,\n      "total_tokens": 33\n    },\n    "finish_reason": "stop"\n  },\n  "metadata": {\n    "provider": "openai",\n    "model": "gpt-4o-mini",\n    "tags": ["qa", "geography"],\n    "duration_ms": 1250,\n    "request_id": "req_abc123",\n    "response_id": "resp_xyz789"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"field-descriptions",children:"Field Descriptions"}),"\n",(0,r.jsx)(n.h3,{id:"root-fields",children:"Root Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"timestamp"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"ISO 8601 timestamp when the request was made"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"input"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"LLM request parameters"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"output"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"LLM response data"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"metadata"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Additional tracking information"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"input-fields",children:"Input Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"model"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:'LLM model name (e.g., "gpt-4o-mini")'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"messages"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"Chat completion messages"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"temperature"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Sampling temperature (0-2)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"max_tokens"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Maximum tokens to generate"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"top_p"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Nucleus sampling parameter"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"frequency_penalty"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Frequency penalty (-2 to 2)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"presence_penalty"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Presence penalty (-2 to 2)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stop"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"Stop sequences"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"stream"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"Whether response was streamed"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"output-fields",children:"Output Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"content"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Generated text content"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"role"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:'Response role (usually "assistant")'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"usage"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Token usage information"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"finish_reason"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Why generation stopped"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tool_calls"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"Function/tool calls made"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"usage-fields",children:"Usage Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"prompt_tokens"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Tokens in the prompt"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"completion_tokens"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Tokens in the completion"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"total_tokens"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Total tokens used"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"metadata-fields",children:"Metadata Fields"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"provider"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"LLM provider (openai, anthropic, etc.)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"model"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Model name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tags"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"Custom tags for filtering"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"duration_ms"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"Request duration in milliseconds"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"request_id"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Unique request identifier"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"response_id"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Unique response identifier"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"error"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"Error message if request failed"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"provider-specific-examples",children:"Provider-Specific Examples"}),"\n",(0,r.jsx)(n.h3,{id:"openai",children:"OpenAI"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": {\n    "model": "gpt-4o-mini",\n    "messages": [\n      {"role": "user", "content": "Hello!"}\n    ],\n    "temperature": 0.7,\n    "max_tokens": 1000\n  },\n  "output": {\n    "content": "Hello! How can I help you today?",\n    "role": "assistant",\n    "usage": {\n      "prompt_tokens": 10,\n      "completion_tokens": 8,\n      "total_tokens": 18\n    },\n    "finish_reason": "stop"\n  },\n  "metadata": {\n    "provider": "openai",\n    "model": "gpt-4o-mini",\n    "tags": ["greeting"],\n    "duration_ms": 1250\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"anthropic",children:"Anthropic"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": {\n    "model": "claude-3-haiku-20240307",\n    "messages": [\n      {"role": "user", "content": "Hello!"}\n    ],\n    "max_tokens": 1000,\n    "temperature": 0.7\n  },\n  "output": {\n    "content": "Hello! How can I assist you today?",\n    "role": "assistant",\n    "usage": {\n      "input_tokens": 10,\n      "output_tokens": 8,\n      "total_tokens": 18\n    },\n    "stop_reason": "end_turn"\n  },\n  "metadata": {\n    "provider": "anthropic",\n    "model": "claude-3-haiku-20240307",\n    "tags": ["greeting"],\n    "duration_ms": 1100\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"error-events",children:"Error Events"}),"\n",(0,r.jsx)(n.p,{children:"When LLM calls fail, error information is captured:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": {\n    "model": "gpt-4o-mini",\n    "messages": [\n      {"role": "user", "content": "Hello!"}\n    ]\n  },\n  "output": null,\n  "metadata": {\n    "provider": "openai",\n    "model": "gpt-4o-mini",\n    "tags": ["greeting"],\n    "duration_ms": 5000,\n    "error": "Rate limit exceeded"\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"streaming-events",children:"Streaming Events"}),"\n",(0,r.jsx)(n.p,{children:"For streaming responses, events are captured when the stream completes:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": {\n    "model": "gpt-4o-mini",\n    "messages": [\n      {"role": "user", "content": "Tell me a story"}\n    ],\n    "stream": true\n  },\n  "output": {\n    "content": "Once upon a time...",\n    "role": "assistant",\n    "usage": {\n      "prompt_tokens": 15,\n      "completion_tokens": 250,\n      "total_tokens": 265\n    },\n    "finish_reason": "stop"\n  },\n  "metadata": {\n    "provider": "openai",\n    "model": "gpt-4o-mini",\n    "tags": ["story"],\n    "duration_ms": 8500,\n    "stream": true\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"custom-tags",children:"Custom Tags"}),"\n",(0,r.jsx)(n.p,{children:"Events can be tagged for targeted evaluation:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-15T14:30:25.123Z",\n  "input": { ... },\n  "output": { ... },\n  "metadata": {\n    "provider": "openai",\n    "model": "gpt-4o-mini",\n    "tags": [\n      "customer-support",\n      "priority-high",\n      "v1.0"\n    ],\n    "duration_ms": 1250\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"reading-event-data",children:"Reading Event Data"}),"\n",(0,r.jsx)(n.h3,{id:"command-line",children:"Command Line"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# View recent events\ntail -f data/events/$(date +%Y-%m-%d).jsonl\n\n# Count events\nwc -l data/events/*.jsonl\n\n# Filter by tag\ngrep '\"customer-support\"' data/events/*.jsonl\n"})}),"\n",(0,r.jsx)(n.h3,{id:"python",children:"Python"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import json\nfrom pathlib import Path\n\ndef read_events(data_folder):\n    events = []\n    events_dir = Path(data_folder) / "events"\n    \n    for event_file in events_dir.glob("*.jsonl"):\n        with open(event_file) as f:\n            for line in f:\n                events.append(json.loads(line))\n    \n    return events\n\n# Usage\nevents = read_events("trainloop/data")\nprint(f"Found {len(events)} events")\n'})}),"\n",(0,r.jsx)(n.h3,{id:"sql-via-duckdb",children:"SQL (via DuckDB)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Query events in Studio UI\nSELECT \n  timestamp,\n  metadata.provider,\n  metadata.model,\n  metadata.tags,\n  input.model,\n  output.content\nFROM 'data/events/*.jsonl'\nWHERE 'customer-support' = ANY(metadata.tags)\nORDER BY timestamp DESC\nLIMIT 10;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tagging"}),": Use meaningful tags for targeted evaluation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Retention"}),": Regularly clean up old event files"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Monitoring"}),": Track event volume and storage usage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security"}),": Avoid logging sensitive information"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Compression"}),": Compress old event files to save space"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/reference/data-formats/results",children:"Results Data Format"})," - Evaluation results schema"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/reference/sdks/",children:"SDK Reference"})," - How to collect event data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"/reference/cli/eval",children:"CLI Reference"})," - How to process event data"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>l});var s=t(6540);const r={},i=s.createContext(r);function d(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);